# 趋势共振策略 (Trend Confluence)

## 策略概述

趋势共振策略结合 **VWAP (成交量加权平均价)** 和 **VIX (波动率指数)** 双重过滤，在低波动、趋势明确时入场。

## 核心理念

**顺势而为，择机入场** - 只在价格位于 VWAP 之上且市场波动率较低时做多。

## 📊 交易逻辑

### 买入信号

1. **价格位置**：收盘价 > 月度锚定 VWAP
2. **波动率过滤**：VIX < VIX 的 20 日均线

**解释**：

- VWAP 代表平均成本，价格在上方说明多头占优
- VIX 低于均线说明市场恐慌情绪缓解

### 卖出信号（平仓）

1. **趋势破坏**：收盘价 < VWAP

### 风险控制

- ✅ **只做多** (Long Only)
- ✅ **双重过滤** - 价格和波动率同时满足
- ✅ **月度重置** - VWAP 每月重新计算

## 📈 执行步骤

### 第 1 步：计算月度锚定 VWAP

```python
# 典型价格
TP = (High + Low + Close) / 3

# 价格*成交量
TPV = TP * Volume

# 按月分组累计
按月分组:
    CumTPV = TPV.cumsum()
    CumVol = Volume.cumsum()
    VWAP = CumTPV / CumVol
```

### 第 2 步：计算 VIX 过滤条件

```python
# 获取VIX数据
VIX_Close = 从VIX数据获取

# 计算VIX均线
VIX_MA20 = VIX_Close.rolling(20).mean()

# 判断条件
VIX条件 = VIX_Close < VIX_MA20
```

### 第 3 步：生成交易信号

```python
买入信号 = (Close > VWAP) AND VIX条件
卖出信号 = Close < VWAP

if 买入信号:
    Signal = 1
elif 卖出信号:
    Signal = 0
```

## 💡 策略优势

1. **趋势跟随** - VWAP 确保顺势交易
2. **低波入场** - VIX 过滤避免高波动期
3. **自适应** - VWAP 每月重置，适应市场变化

## ⚠️ 适用场景

- ✅ **牛市趋势** - 价格持续在 VWAP 之上
- ✅ **低波动期** - VIX 处于低位时效果最佳
- ❌ **震荡市** - 频繁穿越 VWAP 会导致鞭打损失

## 📊 关键参数

| 参数     | 值       | 说明             |
| -------- | -------- | ---------------- |
| VWAP     | 月度锚定 | 每月重置一次     |
| VIX 均线 | 20 天    | 波动率参考线     |
| 成交量   | 必需     | 计算 VWAP 的权重 |

## 🎯 VWAP 原理

VWAP (Volume Weighted Average Price) 是机构常用的基准价格：

```
VWAP = Σ(价格 × 成交量) / Σ(成交量)
```

**意义**：

- 价格 > VWAP → 多头占优，当前买家愿意付高价
- 价格 < VWAP → 空头占优，卖压较大

## 🔄 月度重置逻辑

传统 VWAP 每日重置，我们使用**月度锚定**：

- 好处：更反映中期趋势
- 适用：日线级别交易

## 📉 VIX 的作用

VIX (恐慌指数) 衡量市场波动预期：

- VIX 高 → 市场恐慌，不确定性大
- VIX 低 → 市场平静，趋势更稳定

我们只在 VIX < MA20 时入场，避免在高波动期被甩出。

## 🎯 预期表现

- **市场环境**: 牛市或低波动期
- **交易频率**: 中等偏低
- **胜率**: 较高（双重过滤）
- **风险收益比**: 良好

---

**提示**：如果 VIX 数据不可用，策略会忽略 VIX 过滤条件。
